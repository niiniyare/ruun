{
  "version": 3,
  "sources": ["../../js/basecoat/dropdown-menu.js"],
  "sourcesContent": ["(() => {\n  const initDropdownMenu = (dropdownMenuComponent) => {\n    const trigger = dropdownMenuComponent.querySelector(':scope > button');\n    const popover = dropdownMenuComponent.querySelector(':scope > [data-popover]');\n    const menu = popover.querySelector('[role=\"menu\"]');\n    \n    if (!trigger || !menu || !popover) {\n      const missing = [];\n      if (!trigger) missing.push('trigger');\n      if (!menu) missing.push('menu');\n      if (!popover) missing.push('popover');\n      console.error(`Dropdown menu initialisation failed. Missing element(s): ${missing.join(', ')}`, dropdownMenuComponent);\n      return;\n    }\n\n    let menuItems = [];\n    let activeIndex = -1;\n\n    const closePopover = (focusOnTrigger = true) => {\n      if (trigger.getAttribute('aria-expanded') === 'false') return;\n      trigger.setAttribute('aria-expanded', 'false');\n      trigger.removeAttribute('aria-activedescendant');\n      popover.setAttribute('aria-hidden', 'true');\n      \n      if (focusOnTrigger) {\n        trigger.focus();\n      }\n      \n      setActiveItem(-1);\n    };\n\n    const openPopover = (initialSelection = false) => {\n      document.dispatchEvent(new CustomEvent('basecoat:popover', {\n        detail: { source: dropdownMenuComponent }\n      }));\n      \n      trigger.setAttribute('aria-expanded', 'true');\n      popover.setAttribute('aria-hidden', 'false');\n      menuItems = Array.from(menu.querySelectorAll('[role^=\"menuitem\"]')).filter(item => \n        !item.hasAttribute('disabled') && \n        item.getAttribute('aria-disabled') !== 'true'\n      );\n      \n      if (menuItems.length > 0 && initialSelection) {\n        if (initialSelection === 'first') {\n          setActiveItem(0);\n        } else if (initialSelection === 'last') {\n          setActiveItem(menuItems.length - 1);\n        }\n      }\n    };\n\n    const setActiveItem = (index) => {\n      if (activeIndex > -1 && menuItems[activeIndex]) {\n        menuItems[activeIndex].classList.remove('active');\n      }\n      activeIndex = index;\n      if (activeIndex > -1 && menuItems[activeIndex]) {\n        const activeItem = menuItems[activeIndex];\n        activeItem.classList.add('active');\n        trigger.setAttribute('aria-activedescendant', activeItem.id);\n      } else {\n        trigger.removeAttribute('aria-activedescendant');\n      }\n    };\n\n    trigger.addEventListener('click', () => {\n      const isExpanded = trigger.getAttribute('aria-expanded') === 'true';\n      if (isExpanded) {\n        closePopover();\n      } else {\n        openPopover(false);\n      }\n    });\n\n    dropdownMenuComponent.addEventListener('keydown', (event) => {\n      const isExpanded = trigger.getAttribute('aria-expanded') === 'true';\n\n      if (event.key === 'Escape') {\n        if (isExpanded) closePopover();\n        return;\n      }\n      \n      if (!isExpanded) {\n        if (['Enter', ' '].includes(event.key)) {\n          event.preventDefault();\n          openPopover(false);\n        } else if (event.key === 'ArrowDown') {\n          event.preventDefault();\n          openPopover('first');\n        } else if (event.key === 'ArrowUp') {\n          event.preventDefault();\n          openPopover('last');\n        }\n        return;\n      }\n\n      if (menuItems.length === 0) return;\n\n      let nextIndex = activeIndex;\n\n      switch (event.key) {\n        case 'ArrowDown':\n          event.preventDefault();\n          nextIndex = activeIndex === -1 ? 0 : Math.min(activeIndex + 1, menuItems.length - 1);\n          break;\n        case 'ArrowUp':\n          event.preventDefault();\n          nextIndex = activeIndex === -1 ? menuItems.length - 1 : Math.max(activeIndex - 1, 0);\n          break;\n        case 'Home':\n          event.preventDefault();\n          nextIndex = 0;\n          break;\n        case 'End':\n          event.preventDefault();\n          nextIndex = menuItems.length - 1;\n          break;\n        case 'Enter':\n        case ' ':\n          event.preventDefault();\n          menuItems[activeIndex]?.click();\n          closePopover();\n          return;\n      }\n\n      if (nextIndex !== activeIndex) {\n        setActiveItem(nextIndex);\n      }\n    });\n\n    menu.addEventListener('mousemove', (event) => {\n      const menuItem = event.target.closest('[role^=\"menuitem\"]');\n      if (menuItem && menuItems.includes(menuItem)) {\n        const index = menuItems.indexOf(menuItem);\n        if (index !== activeIndex) {\n          setActiveItem(index);\n        }\n      }\n    });\n\n    menu.addEventListener('mouseleave', () => {\n      setActiveItem(-1);\n    });\n\n    menu.addEventListener('click', (event) => {\n      if (event.target.closest('[role^=\"menuitem\"]')) {\n        closePopover();\n      }\n    });\n\n    document.addEventListener('click', (event) => {\n      if (!dropdownMenuComponent.contains(event.target)) {\n        closePopover();\n      }\n    });\n\n    document.addEventListener('basecoat:popover', (event) => {\n      if (event.detail.source !== dropdownMenuComponent) {\n        closePopover(false);\n      }\n    });\n\n    dropdownMenuComponent.dataset.dropdownMenuInitialized = true;\n    dropdownMenuComponent.dispatchEvent(new CustomEvent('basecoat:initialized'));\n  };\n\n  if (window.basecoat) {\n    window.basecoat.register('dropdown-menu', '.dropdown-menu:not([data-dropdown-menu-initialized])', initDropdownMenu);\n  }\n})();"],
  "mappings": "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",
  "names": []
}
