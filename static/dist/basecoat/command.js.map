{
  "version": 3,
  "sources": ["../../js/basecoat/command.js"],
  "sourcesContent": ["(() => {\n  const initCommand = (container) => {\n    const input = container.querySelector('header input');\n    const menu = container.querySelector('[role=\"menu\"]');\n\n    if (!input || !menu) {\n      const missing = [];\n      if (!input) missing.push('input');\n      if (!menu) missing.push('menu');\n      console.error(`Command component initialization failed. Missing element(s): ${missing.join(', ')}`, container);\n      return;\n    }\n\n    const allMenuItems = Array.from(menu.querySelectorAll('[role=\"menuitem\"]'));\n    const menuItems = allMenuItems.filter(item => \n      !item.hasAttribute('disabled') && \n      item.getAttribute('aria-disabled') !== 'true'\n    );\n    let visibleMenuItems = [...menuItems];\n    let activeIndex = -1;\n\n    const setActiveItem = (index) => {\n      if (activeIndex > -1 && menuItems[activeIndex]) {\n        menuItems[activeIndex].classList.remove('active');\n      }\n\n      activeIndex = index;\n\n      if (activeIndex > -1) {\n        const activeItem = menuItems[activeIndex];\n        activeItem.classList.add('active');\n        if (activeItem.id) {\n          input.setAttribute('aria-activedescendant', activeItem.id);\n        } else {\n          input.removeAttribute('aria-activedescendant');\n        }\n      } else {\n        input.removeAttribute('aria-activedescendant');\n      }\n    };\n\n    const filterMenuItems = () => {\n      const searchTerm = input.value.trim().toLowerCase();\n\n      setActiveItem(-1);\n\n      visibleMenuItems = [];\n      allMenuItems.forEach(item => {\n        if (item.hasAttribute('data-force')) {\n          item.setAttribute('aria-hidden', 'false');\n          if (menuItems.includes(item)) {\n            visibleMenuItems.push(item);\n          }\n          return;\n        }\n\n        const itemText = (item.dataset.filter || item.textContent).trim().toLowerCase();\n        const keywords = (item.dataset.keywords || '').toLowerCase();\n        const matches = itemText.includes(searchTerm) || keywords.includes(searchTerm);\n        item.setAttribute('aria-hidden', String(!matches));\n        if (matches && menuItems.includes(item)) {\n          visibleMenuItems.push(item);\n        }\n      });\n\n      if (visibleMenuItems.length > 0) {\n        setActiveItem(menuItems.indexOf(visibleMenuItems[0]));\n        visibleMenuItems[0].scrollIntoView({ block: 'nearest' });\n      }\n    };\n\n    input.addEventListener('input', filterMenuItems);\n\n    const handleKeyNavigation = (event) => {\n      if (!['ArrowDown', 'ArrowUp', 'Enter', 'Home', 'End'].includes(event.key)) {\n        return;\n      }\n\n      if (event.key === 'Enter') {\n        event.preventDefault();\n        if (activeIndex > -1) {\n          menuItems[activeIndex]?.click();\n        }\n        return;\n      }\n\n      if (visibleMenuItems.length === 0) return;\n\n      event.preventDefault();\n\n      const currentVisibleIndex = activeIndex > -1 ? visibleMenuItems.indexOf(menuItems[activeIndex]) : -1;\n      let nextVisibleIndex = currentVisibleIndex;\n\n      switch (event.key) {\n        case 'ArrowDown':\n          if (currentVisibleIndex < visibleMenuItems.length - 1) {\n            nextVisibleIndex = currentVisibleIndex + 1;\n          }\n          break;\n        case 'ArrowUp':\n          if (currentVisibleIndex > 0) {\n            nextVisibleIndex = currentVisibleIndex - 1;\n          } else if (currentVisibleIndex === -1) {\n            nextVisibleIndex = 0;\n          }\n          break;\n        case 'Home':\n          nextVisibleIndex = 0;\n          break;\n        case 'End':\n          nextVisibleIndex = visibleMenuItems.length - 1;\n          break;\n      }\n\n      if (nextVisibleIndex !== currentVisibleIndex) {\n        const newActiveItem = visibleMenuItems[nextVisibleIndex];\n        setActiveItem(menuItems.indexOf(newActiveItem));\n        newActiveItem.scrollIntoView({ block: 'nearest', behavior: 'smooth' });\n      }\n    };\n\n    menu.addEventListener('mousemove', (event) => {\n      const menuItem = event.target.closest('[role=\"menuitem\"]');\n      if (menuItem && visibleMenuItems.includes(menuItem)) {\n        const index = menuItems.indexOf(menuItem);\n        if (index !== activeIndex) {\n          setActiveItem(index);\n        }\n      }\n    });\n\n    menu.addEventListener('click', (event) => {\n      const clickedItem = event.target.closest('[role=\"menuitem\"]');\n      if (clickedItem && visibleMenuItems.includes(clickedItem)) {\n        const dialog = container.closest('dialog.command-dialog');\n        if (dialog && !clickedItem.hasAttribute('data-keep-command-open')) {\n          dialog.close();\n        }\n      }\n    });\n\n    input.addEventListener('keydown', handleKeyNavigation);\n\n    if (visibleMenuItems.length > 0) {\n      setActiveItem(menuItems.indexOf(visibleMenuItems[0]));\n      visibleMenuItems[0].scrollIntoView({ block: 'nearest' });\n    }\n\n    container.dataset.commandInitialized = true;\n    container.dispatchEvent(new CustomEvent('basecoat:initialized'));\n  };\n\n  if (window.basecoat) {\n    window.basecoat.register('command', '.command:not([data-command-initialized])', initCommand);\n  }\n})();\n"],
  "mappings": "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",
  "names": []
}
