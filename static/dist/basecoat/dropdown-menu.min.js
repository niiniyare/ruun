"use strict";(()=>{(()=>{const f=s=>{const a=s.querySelector(":scope > button"),u=s.querySelector(":scope > [data-popover]"),c=u.querySelector('[role="menu"]');if(!a||!c||!u){const e=[];a||e.push("trigger"),c||e.push("menu"),u||e.push("popover"),console.error(`Dropdown menu initialisation failed. Missing element(s): ${e.join(", ")}`,s);return}let i=[],t=-1;const d=(e=!0)=>{a.getAttribute("aria-expanded")!=="false"&&(a.setAttribute("aria-expanded","false"),a.removeAttribute("aria-activedescendant"),u.setAttribute("aria-hidden","true"),e&&a.focus(),l(-1))},o=(e=!1)=>{document.dispatchEvent(new CustomEvent("basecoat:popover",{detail:{source:s}})),a.setAttribute("aria-expanded","true"),u.setAttribute("aria-hidden","false"),i=Array.from(c.querySelectorAll('[role^="menuitem"]')).filter(r=>!r.hasAttribute("disabled")&&r.getAttribute("aria-disabled")!=="true"),i.length>0&&e&&(e==="first"?l(0):e==="last"&&l(i.length-1))},l=e=>{if(t>-1&&i[t]&&i[t].classList.remove("active"),t=e,t>-1&&i[t]){const r=i[t];r.classList.add("active"),a.setAttribute("aria-activedescendant",r.id)}else a.removeAttribute("aria-activedescendant")};a.addEventListener("click",()=>{a.getAttribute("aria-expanded")==="true"?d():o(!1)}),s.addEventListener("keydown",e=>{const r=a.getAttribute("aria-expanded")==="true";if(e.key==="Escape"){r&&d();return}if(!r){["Enter"," "].includes(e.key)?(e.preventDefault(),o(!1)):e.key==="ArrowDown"?(e.preventDefault(),o("first")):e.key==="ArrowUp"&&(e.preventDefault(),o("last"));return}if(i.length===0)return;let n=t;switch(e.key){case"ArrowDown":e.preventDefault(),n=t===-1?0:Math.min(t+1,i.length-1);break;case"ArrowUp":e.preventDefault(),n=t===-1?i.length-1:Math.max(t-1,0);break;case"Home":e.preventDefault(),n=0;break;case"End":e.preventDefault(),n=i.length-1;break;case"Enter":case" ":e.preventDefault(),i[t]?.click(),d();return}n!==t&&l(n)}),c.addEventListener("mousemove",e=>{const r=e.target.closest('[role^="menuitem"]');if(r&&i.includes(r)){const n=i.indexOf(r);n!==t&&l(n)}}),c.addEventListener("mouseleave",()=>{l(-1)}),c.addEventListener("click",e=>{e.target.closest('[role^="menuitem"]')&&d()}),document.addEventListener("click",e=>{s.contains(e.target)||d()}),document.addEventListener("basecoat:popover",e=>{e.detail.source!==s&&d(!1)}),s.dataset.dropdownMenuInitialized=!0,s.dispatchEvent(new CustomEvent("basecoat:initialized"))};window.basecoat&&window.basecoat.register("dropdown-menu",".dropdown-menu:not([data-dropdown-menu-initialized])",f)})();})();
