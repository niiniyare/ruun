"use strict";var DataTable=(()=>{var w=Object.defineProperty;var I=Object.getOwnPropertyDescriptor;var M=Object.getOwnPropertyNames;var V=Object.prototype.hasOwnProperty;var N=(n,t)=>{for(var e in t)w(n,e,{get:t[e],enumerable:!0})},O=(n,t,e,a)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of M(t))!V.call(n,s)&&s!==e&&w(n,s,{get:()=>t[s],enumerable:!(a=I(t,s))||a.enumerable});return n};var F=n=>O(w({},"__esModule",{value:!0}),n);var z={};N(z,{DataTable:()=>d,EventEmitter:()=>u,ExportPlugin:()=>m,FilterEngine:()=>g,SortEngine:()=>f,StateManager:()=>p,VERSION:()=>x,VirtualScrollPlugin:()=>S,calculateOptimalOverscan:()=>E,createDataTable:()=>v,createExportPlugin:()=>R,createVirtualScrollPlugin:()=>D,debounce:()=>y,default:()=>k,measureRowHeight:()=>C});var u=class{constructor(){this.events=new Map}on(t,e){return this.events.has(t)||this.events.set(t,new Set),this.events.get(t).add(e),()=>this.off(t,e)}off(t,e){let a=this.events.get(t);a&&a.delete(e)}emit(t,e){let a=this.events.get(t);a&&a.forEach(s=>{try{s(e)}catch(i){console.error(`EventEmitter: Error in ${String(t)} handler:`,i)}})}clear(){this.events.clear()}removeAllListeners(t){t?this.events.delete(t):this.events.clear()}};var p=class{constructor(){this.storage=null;try{typeof window<"u"&&window.localStorage&&(this.storage=window.localStorage)}catch{console.warn("StateManager: localStorage is not available")}}save(t,e){if(this.storage)try{let a=JSON.stringify(e,this.replacer);this.storage.setItem(t,a)}catch(a){console.error("StateManager: Error saving state:",a)}}load(t){if(!this.storage)return null;try{let e=this.storage.getItem(t);return e?JSON.parse(e,this.reviver):null}catch(e){return console.error("StateManager: Error loading state:",e),null}}remove(t){if(this.storage)try{this.storage.removeItem(t)}catch(e){console.error("StateManager: Error removing state:",e)}}clear(){if(this.storage)try{this.storage.clear()}catch(t){console.error("StateManager: Error clearing state:",t)}}replacer(t,e){return e instanceof Set?{__type:"Set",__value:Array.from(e)}:e instanceof Map?{__type:"Map",__value:Array.from(e.entries())}:e instanceof Date?{__type:"Date",__value:e.toISOString()}:e}reviver(t,e){if(e&&typeof e=="object"&&e.__type)switch(e.__type){case"Set":return new Set(e.__value);case"Map":return new Map(e.__value);case"Date":return new Date(e.__value);default:return e}return e}};var g=class{constructor(t){this.options=t}filter(t,e,a){let s=t;return e.filters.length>0&&(s=this.applyColumnFilters(s,e.filters,a)),e.globalSearch&&e.globalSearch.trim()&&(s=this.applyGlobalSearch(s,e.globalSearch,a)),s}applyColumnFilters(t,e,a){return t.filter(s=>e.every(i=>this.evaluateFilter(s,i,a)))}applyGlobalSearch(t,e,a){let s=a.filter(r=>r.filterable!==!1);if(s.length===0)return t;let i=this.options.filtering.caseSensitive?e:e.toLowerCase();return t.filter(r=>s.some(o=>{let l=this.getCellValue(r,o);return this.normalizeValue(l).includes(i)}))}evaluateFilter(t,e,a){if(this.options.filtering.customFilters?.[e.columnId])return this.options.filtering.customFilters[e.columnId](t,e);let s=a.find(r=>r.id===e.columnId);if(!s)return!0;let i=this.getCellValue(t,s);return this.applyOperator(i,e.operator,e.value)}applyOperator(t,e,a){let s=this.normalizeValue(t),i=Array.isArray(a)?a.map(r=>this.normalizeValue(r)):this.normalizeValue(a);switch(e){case"equals":return s===i;case"notEquals":return s!==i;case"contains":return s.includes(i);case"notContains":return!s.includes(i);case"startsWith":return s.startsWith(i);case"endsWith":return s.endsWith(i);case"isEmpty":return t==null||t==="";case"isNotEmpty":return t!=null&&t!=="";case"greaterThan":return this.compareNumeric(t,a)>0;case"greaterThanOrEqual":return this.compareNumeric(t,a)>=0;case"lessThan":return this.compareNumeric(t,a)<0;case"lessThanOrEqual":return this.compareNumeric(t,a)<=0;case"between":if(!Array.isArray(a)||a.length!==2)return!1;let r=this.toNumber(t),o=this.toNumber(a[0]),l=this.toNumber(a[1]);return r>=o&&r<=l;case"in":return Array.isArray(a)?i.includes(s):!1;case"notIn":return Array.isArray(a)?!i.includes(s):!1;default:return console.warn(`FilterEngine: Unknown operator ${e}`),!0}}getCellValue(t,e){return e.accessor?e.accessor(t.data):t.data[e.field]}normalizeValue(t){if(t==null)return"";let e=String(t);return this.options.filtering.caseSensitive?e:e.toLowerCase()}toNumber(t){if(typeof t=="number")return t;if(typeof t=="string"){let e=parseFloat(t);return isNaN(e)?0:e}return 0}compareNumeric(t,e){return this.toNumber(t)-this.toNumber(e)}};function y(n,t){let e=null;return function(...a){e&&clearTimeout(e),e=setTimeout(()=>{n(...a)},t)}}var f=class{constructor(t){this.defaultComparator=(t,e)=>{if(t==null)return e==null?0:-1;if(e==null)return 1;if(typeof t=="number"&&typeof e=="number")return t-e;if(typeof t=="boolean"&&typeof e=="boolean")return t===e?0:t?1:-1;if(this.isDate(t)&&this.isDate(e))return t.getTime()-e.getTime();let a=this.tryParseNumber(t),s=this.tryParseNumber(e);if(a!==null&&s!==null)return a-s;let i=this.tryParseDate(t),r=this.tryParseDate(e);return this.isDate(i)&&this.isDate(r)?i.getTime()-r.getTime():String(t).localeCompare(String(e),void 0,{numeric:!0,sensitivity:"base"})};this.options=t}sort(t,e,a){let s=[...t];return"sorts"in e?this.multiSort(s,e.sorts,a):this.singleSort(s,e,a)}singleSort(t,e,a){let s=a.find(o=>o.id===e.columnId);if(!s||!e.direction)return t;let i=this.getComparator(s),r=e.direction==="asc"?1:-1;return t.sort((o,l)=>{let h=this.getCellValue(o,s),c=this.getCellValue(l,s);return i(h,c)*r})}multiSort(t,e,a){return t.sort((s,i)=>{for(let r of e){if(!r.direction)continue;let o=a.find(P=>P.id===r.columnId);if(!o)continue;let l=this.getComparator(o),h=r.direction==="asc"?1:-1,c=this.getCellValue(s,o),b=this.getCellValue(i,o),T=l(c,b)*h;if(T!==0)return T}return 0})}getComparator(t){return t.comparator?t.comparator:this.options.customComparators[t.id]?this.options.customComparators[t.id]:this.defaultComparator}getCellValue(t,e){return e.accessor?e.accessor(t.data):t.data[e.field]}tryParseNumber(t){if(typeof t=="number")return t;if(typeof t=="string"){if(/^\d{4}-\d{2}-\d{2}/.test(t)||/^\d{1,2}\/\d{1,2}\/\d{4}/.test(t)||/^\d{1,2}-\d{1,2}-\d{4}/.test(t))return null;let e=t.replace(/[,$]/g,""),a=parseFloat(e);return isNaN(a)||e!==String(a)?null:a}return null}tryParseDate(t){if(this.isDate(t))return t;if(typeof t=="string"||typeof t=="number"){if(typeof t=="string"){if(/^\d{4}-\d{2}-\d{2}/.test(t)){let a=new Date(t);return isNaN(a.getTime())?null:a}if(/^\d{1,2}\/\d{1,2}\/\d{4}/.test(t)||/^\d{1,2}-\d{1,2}-\d{4}/.test(t)){let a=new Date(t);return isNaN(a.getTime())?null:a}}let e=new Date(t);return isNaN(e.getTime())?null:e}return null}isDate(t){return t instanceof Date}};var d=class{constructor(t){this.plugins=new Map;this.initialized=!1;this.destroyed=!1;this.options=this.normalizeOptions(t),this.eventEmitter=new u,this.stateManager=new p,this.filterEngine=new g(this.options),this.sortEngine=new f(this.options),this.state=this.createInitialState(),this.initialize()}normalizeOptions(t){return{data:t.data||[],columns:t.columns,dataMode:t.dataMode||"client",serverSide:{url:"",method:"GET",headers:{},params:{},dataPath:"data",totalPath:"total",transformer:e=>({data:e.data||e,total:e.total||e.data?.length||0}),...t.serverSide},sorting:{enabled:!0,multiSort:!1,defaultSort:void 0,...t.sorting},filtering:{enabled:!0,globalSearch:!0,debounceMs:300,caseSensitive:!1,customFilters:{},...t.filtering},pagination:{enabled:!0,pageSize:10,pageSizeOptions:[5,10,25,50,100],showFirstLast:!0,...t.pagination},selection:{enabled:!1,multiple:!0,mode:"checkbox",selectOnRowClick:!1,...t.selection},virtualScroll:{enabled:!1,rowHeight:48,overscan:5,...t.virtualScroll},rowId:t.rowId||"id",enableRowExpansion:t.enableRowExpansion||!1,preserveState:t.preserveState||!1,stateKey:t.stateKey||"datatable-state",customComparators:t.customComparators||{},customFormatters:t.customFormatters||{},onInit:t.onInit||(()=>{}),onDataChange:t.onDataChange||(()=>{}),onError:t.onError||(()=>{})}}createInitialState(){let t=this.options.columns.map(e=>({visible:!0,sortable:!0,filterable:!0,...e}));return{rows:[],columns:t,sortState:this.options.sorting.defaultSort||void 0,filterState:{filters:[],globalSearch:""},paginationState:{pageIndex:0,pageSize:this.options.pagination.pageSize,totalRows:0,totalPages:0},selectionState:{selectedRowIds:new Set,isAllSelected:!1,isPartiallySelected:!1},loadState:{loading:!1,error:null},visibleRows:[],filteredRows:[],sortedRows:[],paginatedRows:[],visibleColumns:t.filter(e=>e.visible!==!1)}}initialize(){this.initialized||(this.options.preserveState&&this.restoreState(),this.options.dataMode==="client"&&this.options.data.length>0?this.setData(this.options.data):this.options.dataMode==="server"&&this.reload(),this.initialized=!0,this.emit("init"),this.options.onInit())}setData(t){this.ensureNotDestroyed();let e=t.map(a=>({id:this.getRowId(a),data:a,selected:!1,expanded:!1,disabled:!1}));this.state.rows=e,this.state.paginationState.totalRows=e.length,this.recompute(),this.emit("data:change",e),this.emit("data:load",e),this.options.onDataChange(e)}getData(){return[...this.state.rows]}addRow(t){this.ensureNotDestroyed();let e={id:this.getRowId(t),data:t,selected:!1,expanded:!1,disabled:!1};this.state.rows.push(e),this.state.paginationState.totalRows=this.state.rows.length,this.recompute(),this.emit("data:change",this.state.rows)}updateRow(t,e){this.ensureNotDestroyed();let a=this.state.rows.find(s=>s.id===t);if(!a){console.warn(`DataTable: Row with id ${t} not found`);return}a.data={...a.data,...e},this.recompute(),this.emit("data:change",this.state.rows)}deleteRow(t){this.ensureNotDestroyed();let e=this.state.rows.findIndex(a=>a.id===t);if(e===-1){console.warn(`DataTable: Row with id ${t} not found`);return}this.state.rows.splice(e,1),this.state.paginationState.totalRows=this.state.rows.length,this.state.selectionState.selectedRowIds.delete(t),this.recompute(),this.emit("data:change",this.state.rows)}clearData(){this.ensureNotDestroyed(),this.state.rows=[],this.state.paginationState.totalRows=0,this.state.selectionState.selectedRowIds.clear(),this.recompute(),this.emit("data:change",[])}getColumns(){return[...this.state.columns]}setColumns(t){this.ensureNotDestroyed(),this.state.columns=t.map(e=>({visible:!0,sortable:!0,filterable:!0,...e})),this.state.visibleColumns=this.state.columns.filter(e=>e.visible!==!1),this.emit("state:change",this.state)}showColumn(t){this.toggleColumnVisibility(t,!0)}hideColumn(t){this.toggleColumnVisibility(t,!1)}toggleColumn(t){let e=this.state.columns.find(a=>a.id===t);e&&this.toggleColumnVisibility(t,!e.visible)}toggleColumnVisibility(t,e){this.ensureNotDestroyed();let a=this.state.columns.find(s=>s.id===t);if(!a){console.warn(`DataTable: Column ${t} not found`);return}a.visible=e,this.state.visibleColumns=this.state.columns.filter(s=>s.visible!==!1),this.emit("column:visibility",{columnId:t,visible:e}),this.emit("state:change",this.state)}sort(t,e){if(this.ensureNotDestroyed(),!this.options.sorting.enabled){console.warn("DataTable: Sorting is disabled");return}let a=this.state.columns.find(i=>i.id===t);if(!a||a.sortable===!1){console.warn(`DataTable: Column ${t} is not sortable`);return}let s=e??"asc";if(!e){let i=this.state.sortState;i?.columnId===t&&(i.direction==="asc"?s="desc":i.direction==="desc"&&(s=null))}this.state.sortState=s?{columnId:t,direction:s}:void 0,this.options.dataMode==="client"?this.recompute():this.reload(),this.emit("sort:change",this.state.sortState),this.emit("state:change",this.state)}multiSort(t){if(this.ensureNotDestroyed(),!this.options.sorting.enabled||!this.options.sorting.multiSort){console.warn("DataTable: Multi-sort is not enabled");return}this.state.sortState={sorts:t},this.options.dataMode==="client"?this.recompute():this.reload(),this.emit("sort:change",this.state.sortState),this.emit("state:change",this.state)}clearSort(){this.state.sortState=void 0,this.options.dataMode==="client"?this.recompute():this.reload(),this.emit("sort:change",this.state.sortState),this.emit("state:change",this.state)}getSortState(){return this.state.sortState}filter(t){if(this.ensureNotDestroyed(),!this.options.filtering.enabled){console.warn("DataTable: Filtering is disabled");return}this.state.filterState.filters=t,this.options.dataMode==="client"?this.recompute():this.reload(),this.emit("filter:change",this.state.filterState),this.emit("state:change",this.state)}addFilter(t){this.ensureNotDestroyed(),this.state.filterState.filters=this.state.filterState.filters.filter(e=>e.columnId!==t.columnId),this.state.filterState.filters.push(t),this.options.dataMode==="client"?this.recompute():this.reload(),this.emit("filter:change",this.state.filterState),this.emit("state:change",this.state)}removeFilter(t){this.ensureNotDestroyed(),this.state.filterState.filters=this.state.filterState.filters.filter(e=>e.columnId!==t),this.options.dataMode==="client"?this.recompute():this.reload(),this.emit("filter:change",this.state.filterState),this.emit("state:change",this.state)}clearFilters(){this.state.filterState.filters=[],this.state.filterState.globalSearch="",this.options.dataMode==="client"?this.recompute():this.reload(),this.emit("filter:change",this.state.filterState),this.emit("state:change",this.state)}search(t){if(this.ensureNotDestroyed(),!this.options.filtering.enabled||!this.options.filtering.globalSearch){console.warn("DataTable: Global search is not enabled");return}this.state.filterState.globalSearch=t,this.options.dataMode==="client"?this.recompute():this.reload(),this.emit("search:change",t),this.emit("filter:change",this.state.filterState),this.emit("state:change",this.state)}getFilterState(){return{...this.state.filterState}}goToPage(t){if(this.ensureNotDestroyed(),!this.options.pagination.enabled){console.warn("DataTable: Pagination is disabled");return}let e=this.state.paginationState.totalPages,a=Math.max(0,Math.min(t,e-1));a!==this.state.paginationState.pageIndex&&(this.state.paginationState.pageIndex=a,this.options.dataMode==="client"?this.recompute():this.reload(),this.emit("page:change",this.state.paginationState),this.emit("state:change",this.state))}nextPage(){this.goToPage(this.state.paginationState.pageIndex+1)}previousPage(){this.goToPage(this.state.paginationState.pageIndex-1)}firstPage(){this.goToPage(0)}lastPage(){this.goToPage(this.state.paginationState.totalPages-1)}setPageSize(t){if(this.ensureNotDestroyed(),!this.options.pagination.enabled){console.warn("DataTable: Pagination is disabled");return}this.state.paginationState.pageSize=t,this.state.paginationState.pageIndex=0,this.options.dataMode==="client"?this.recompute():this.reload(),this.emit("page:change",this.state.paginationState),this.emit("state:change",this.state)}getPaginationState(){return{...this.state.paginationState}}selectRow(t){if(this.ensureNotDestroyed(),!this.options.selection.enabled){console.warn("DataTable: Selection is disabled");return}this.options.selection.multiple||this.state.selectionState.selectedRowIds.clear();let e=this.state.rows.find(a=>a.id===t);!e||e.disabled||(e.selected=!0,this.state.selectionState.selectedRowIds.add(t),this.updateSelectionState(),this.emit("row:select",{row:e,selected:!0}),this.emit("selection:change",this.state.selectionState),this.emit("state:change",this.state))}deselectRow(t){this.ensureNotDestroyed();let e=this.state.rows.find(a=>a.id===t);e&&(e.selected=!1,this.state.selectionState.selectedRowIds.delete(t),this.updateSelectionState(),this.emit("row:select",{row:e,selected:!1}),this.emit("selection:change",this.state.selectionState),this.emit("state:change",this.state))}toggleRowSelection(t){this.state.selectionState.selectedRowIds.has(t)?this.deselectRow(t):this.selectRow(t)}selectAll(){if(this.ensureNotDestroyed(),!this.options.selection.enabled||!this.options.selection.multiple){console.warn("DataTable: Multi-selection is not enabled");return}this.state.visibleRows.forEach(t=>{t.disabled||(t.selected=!0,this.state.selectionState.selectedRowIds.add(t.id))}),this.updateSelectionState(),this.emit("selection:change",this.state.selectionState),this.emit("state:change",this.state)}deselectAll(){this.ensureNotDestroyed(),this.state.rows.forEach(t=>{t.selected=!1}),this.state.selectionState.selectedRowIds.clear(),this.updateSelectionState(),this.emit("selection:change",this.state.selectionState),this.emit("state:change",this.state)}getSelectedRows(){return this.state.rows.filter(t=>this.state.selectionState.selectedRowIds.has(t.id))}getSelectionState(){return{selectedRowIds:new Set(this.state.selectionState.selectedRowIds),isAllSelected:this.state.selectionState.isAllSelected,isPartiallySelected:this.state.selectionState.isPartiallySelected}}updateSelectionState(){let t=this.state.visibleRows.filter(a=>!a.disabled),e=this.state.selectionState.selectedRowIds.size;this.state.selectionState.isAllSelected=t.length>0&&e===t.length,this.state.selectionState.isPartiallySelected=e>0&&e<t.length}getState(){return{...this.state}}setState(t){this.ensureNotDestroyed(),this.state={...this.state,...t},this.emit("state:change",this.state)}resetState(){this.state=this.createInitialState(),this.clearFilters(),this.clearSort(),this.deselectAll(),this.firstPage(),this.emit("state:change",this.state)}saveState(){this.options.preserveState&&this.stateManager.save(this.options.stateKey,this.state)}restoreState(){let t=this.stateManager.load(this.options.stateKey);t&&(this.state={...this.state,...t})}async reload(){if(this.options.dataMode!=="server"){console.warn("DataTable: Server-side mode is not enabled");return}if(!this.options.serverSide.url){console.error("DataTable: Server URL is not configured");return}this.state.loadState.loading=!0,this.state.loadState.error=null,this.emit("state:change",this.state);try{let t=this.buildServerParams(),e=new URL(this.options.serverSide.url);this.options.serverSide.method==="GET"&&Object.entries(t).forEach(([o,l])=>{e.searchParams.append(o,String(l))});let a=await fetch(e.toString(),{method:this.options.serverSide.method,headers:{"Content-Type":"application/json",...this.options.serverSide.headers},body:this.options.serverSide.method==="POST"?JSON.stringify(t):void 0});if(!a.ok)throw new Error(`HTTP ${a.status}: ${a.statusText}`);let s=await a.json(),{data:i,total:r}=this.options.serverSide.transformer(s);this.setData(i),this.state.paginationState.totalRows=r,this.state.paginationState.totalPages=Math.ceil(r/this.state.paginationState.pageSize),this.state.loadState.lastFetch=new Date,this.emit("data:load",this.state.rows)}catch(t){this.state.loadState.error=t,this.emit("data:error",t),this.options.onError(t)}finally{this.state.loadState.loading=!1,this.emit("state:change",this.state)}}buildServerParams(){let t={...this.options.serverSide.params};return this.options.pagination.enabled&&(t.page=this.state.paginationState.pageIndex,t.pageSize=this.state.paginationState.pageSize),this.state.sortState&&("sorts"in this.state.sortState?t.sort=this.state.sortState.sorts:(t.sortBy=this.state.sortState.columnId,t.sortDir=this.state.sortState.direction)),this.state.filterState.filters.length>0&&(t.filters=this.state.filterState.filters),this.state.filterState.globalSearch&&(t.search=this.state.filterState.globalSearch),t}recompute(){let t=[...this.state.rows];if(this.options.filtering.enabled&&(t=this.filterEngine.filter(t,this.state.filterState,this.state.columns)),this.state.filteredRows=t,this.options.sorting.enabled&&this.state.sortState&&(t=this.sortEngine.sort(t,this.state.sortState,this.state.columns)),this.state.sortedRows=t,this.state.paginationState.totalRows=t.length,this.state.paginationState.totalPages=Math.ceil(t.length/this.state.paginationState.pageSize),this.options.pagination.enabled){let e=this.state.paginationState.pageIndex*this.state.paginationState.pageSize,a=e+this.state.paginationState.pageSize;t=t.slice(e,a)}this.state.paginatedRows=t,this.state.visibleRows=t,this.updateSelectionState(),this.options.preserveState&&this.saveState(),this.emit("state:change",this.state)}on(t,e){return this.eventEmitter.on(t,e)}off(t,e){this.eventEmitter.off(t,e)}emit(t,e){this.eventEmitter.emit(t,e)}use(t){if(this.plugins.has(t.name)){console.warn(`DataTable: Plugin ${t.name} is already installed`);return}t.install(this),this.plugins.set(t.name,t)}getRowId(t){return typeof this.options.rowId=="function"?this.options.rowId(t):t[this.options.rowId]}ensureNotDestroyed(){if(this.destroyed)throw new Error("DataTable: Instance has been destroyed")}destroy(){this.destroyed||(this.emit("destroy"),this.eventEmitter.clear(),this.plugins.forEach(t=>{t.uninstall&&t.uninstall(this)}),this.plugins.clear(),this.destroyed=!0)}};function v(n){return new d(n)}var m=class{constructor(){this.name="export";this.version="1.0.0";this.table=null}install(t){this.table=t}export(t){if(!this.table){console.error("ExportPlugin: Table instance not available");return}let e=this.table.getState(),a=e.rows;t.selectedOnly?a=this.table.getSelectedRows():t.visibleOnly&&(a=e.visibleRows);let s=t.columns?e.columns.filter(l=>t.columns.includes(l.id)):e.visibleColumns,i,r,o;switch(t.format){case"csv":i=this.toCSV(a,s,t.includeHeaders??!0),r="text/csv",o="csv";break;case"json":i=this.toJSON(a,s),r="application/json",o="json";break;case"txt":i=this.toTXT(a,s,t.includeHeaders??!0),r="text/plain",o="txt";break;case"xlsx":console.warn("ExportPlugin: XLSX export requires additional library");return;default:console.error(`ExportPlugin: Unsupported format ${t.format}`);return}this.download(i,t.filename||`export-${Date.now()}`,r,o)}toCSV(t,e,a){let s=[];if(a){let i=e.map(r=>this.escapeCSV(r.label||r.id));s.push(i.join(","))}return t.forEach(i=>{let r=e.map(o=>{let l=this.getCellValue(i,o);return this.escapeCSV(l)});s.push(r.join(","))}),s.join(`
`)}toJSON(t,e){let a=t.map(s=>{let i={};return e.forEach(r=>{i[r.label||r.id]=this.getCellValue(s,r)}),i});return JSON.stringify(a,null,2)}toTXT(t,e,a){let s=[],i=e.map(r=>{let o=(r.label||r.id).length,l=t.length>0?Math.max(...t.map(h=>String(this.getCellValue(h,r)).length),0):0;return Math.max(o,l)});if(a){let r=e.map((o,l)=>(o.label||o.id).padEnd(i[l]||0)).join(" | ");s.push(r),s.push(i.map(o=>"-".repeat(o||0)).join("-+-"))}return t.forEach(r=>{let o=e.map((l,h)=>String(this.getCellValue(r,l)).padEnd(i[h]||0)).join(" | ");s.push(o)}),s.join(`
`)}getCellValue(t,e){return e.accessor?e.accessor(t.data):e.formatter?e.formatter(t.data[e.field],t.data):t.data[e.field]}escapeCSV(t){if(t==null)return"";let e=String(t);return e.includes(",")||e.includes('"')||e.includes(`
`)?`"${e.replace(/"/g,'""')}"`:e}download(t,e,a,s){let i=new Blob([t],{type:a}),r=URL.createObjectURL(i),o=document.createElement("a");o.href=r,o.download=`${e}.${s}`,o.click(),setTimeout(()=>URL.revokeObjectURL(r),100)}};function R(){return new m}var S=class{constructor(t){this.name="virtualScroll";this.version="1.0.0";this.table=null;this.scrollContainer=null;this.rafId=null;this.options={overscan:5,...t},this.state={scrollTop:0,visibleStartIndex:0,visibleEndIndex:0,virtualRows:[],totalHeight:0,offsetY:0}}install(t){this.table=t,t.on("data:change",this.handleDataChange.bind(this)),t.on("state:change",this.handleStateChange.bind(this))}uninstall(t){this.cleanup()}attachToContainer(t){this.scrollContainer=t,this.scrollContainer.addEventListener("scroll",this.handleScroll.bind(this)),this.calculateVisibleRows()}detachFromContainer(){this.scrollContainer&&(this.scrollContainer.removeEventListener("scroll",this.handleScroll.bind(this)),this.scrollContainer=null)}getState(){return{...this.state}}handleScroll(t){this.scrollContainer&&(this.rafId&&cancelAnimationFrame(this.rafId),this.rafId=requestAnimationFrame(()=>{this.state.scrollTop=this.scrollContainer.scrollTop,this.calculateVisibleRows(),this.options.onScroll&&this.options.onScroll(this.state.scrollTop)}))}calculateVisibleRows(){if(!this.table)return;let t=this.table.getState(),e;t.paginationState?.enabled&&t.paginatedRows.length>0?e=t.paginatedRows:e=t.filteredRows.length>0?t.filteredRows:t.rows;let a=e.length,{rowHeight:s,containerHeight:i,overscan:r=5}=this.options;if(this.state.totalHeight=a*s,i<=0){this.state.visibleStartIndex=0,this.state.visibleEndIndex=0,this.state.offsetY=0,this.state.virtualRows=[];return}let o=this.state.scrollTop,l=Math.floor(o/s),h=Math.ceil((o+i)/s),c=Math.max(0,l-r),b=Math.min(a,h+r);this.state.visibleStartIndex=c,this.state.visibleEndIndex=b,this.state.offsetY=c*s,this.state.virtualRows=e.slice(c,b)}handleDataChange(t){this.calculateVisibleRows()}handleStateChange(){this.calculateVisibleRows()}scrollToRow(t){if(!this.scrollContainer)return;let e=t*this.options.rowHeight;this.scrollContainer.scrollTop=e}scrollToTop(){this.scrollToRow(0)}scrollToBottom(){if(!this.table)return;let t=this.table.getState(),e;t.paginationState?.enabled&&t.paginatedRows.length>0?e=t.paginatedRows:e=t.filteredRows.length>0?t.filteredRows:t.rows,this.scrollToRow(e.length-1)}cleanup(){this.detachFromContainer(),this.rafId&&(cancelAnimationFrame(this.rafId),this.rafId=null)}};function D(n){return new S(n)}function C(n){let t=window.getComputedStyle(n),e=parseFloat(t.marginTop)||0,a=parseFloat(t.marginBottom)||0;return n.offsetHeight+e+a}function E(n,t){if(n<=0||t<=0)return 3;let e=Math.ceil(t/n);return Math.max(3,Math.floor(e*.5))}var x="2.0.0",k={DataTable:d,createDataTable:v,VERSION:x};return F(z);})();
/**
 * Awo DataTable
 * Headless DataTable for any design system
 * 
 * @package @awo/datatable
 * @author Awo ERP
 * @version 2.0.0
 * @license MIT
 */
