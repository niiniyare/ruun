// Code generated by templ - DO NOT EDIT.

// templ: version: v0.3.943
package organisms

//lint:file-ignore SA4006 This context is only used if a nested component is present.

import "github.com/a-h/templ"
import templruntime "github.com/a-h/templ/runtime"

// SCHEMA INTEGRATION UPDATE GUIDE
// This file shows how to update the existing SchemaForm component to support all new field types

// Enhanced mapping function for schema types to form field types
func mapSchemaTypeToFormType(schemaType string, widget string) molecules.FormFieldType {
	// Widget override - highest priority
	if widget != "" {
		switch widget {
		// Text widgets
		case "textarea":
			return molecules.FormFieldTextarea
		case "password":
			return molecules.FormFieldPassword
		case "email":
			return molecules.FormFieldEmail
		case "search":
			return molecules.FormFieldSearch

		// Selection widgets
		case "select":
			return molecules.FormFieldSelect
		case "radio":
			return molecules.FormFieldRadio
		case "checkbox":
			return molecules.FormFieldCheckbox
		case "checkbox-group":
			return molecules.FormFieldCheckboxGroup
		case "multi-select":
			return molecules.FormFieldMultiSelect
		case "autocomplete":
			return molecules.FormFieldAutoComplete
		case "tags":
			return molecules.FormFieldTags

		// Date/time widgets
		case "date":
			return molecules.FormFieldDate
		case "time":
			return molecules.FormFieldTime
		case "datetime":
			return molecules.FormFieldDateTime
		case "date-range":
			return molecules.FormFieldDateRange
		}
	}

	// Schema type mapping - fallback to type-based mapping
	switch schemaType {
	// Text types
	case "string":
		return molecules.FormFieldText
	case "email":
		return molecules.FormFieldEmail
	case "password":
		return molecules.FormFieldPassword
	case "text", "longtext":
		return molecules.FormFieldTextarea
	case "url":
		return molecules.FormFieldText
	case "phone":
		return molecules.FormFieldText

	// Number types
	case "number", "integer", "float":
		return molecules.FormFieldNumber
	case "currency":
		return molecules.FormFieldNumber // With currency formatting

	// Boolean types
	case "boolean":
		return molecules.FormFieldCheckbox

	// Date/time types
	case "date":
		return molecules.FormFieldDate
	case "time":
		return molecules.FormFieldTime
	case "datetime", "timestamp":
		return molecules.FormFieldDateTime
	case "date-range":
		return molecules.FormFieldDateRange

	// Array/selection types
	case "array":
		// Check if it has predefined options
		return molecules.FormFieldCheckboxGroup
	case "enum":
		return molecules.FormFieldRadio
	case "reference", "foreign-key":
		return molecules.FormFieldAutoComplete

	// File types
	case "file":
		return molecules.FormFieldText // File upload component when implemented
	case "image":
		return molecules.FormFieldText // Image upload component when implemented

	default:
		return molecules.FormFieldText
	}
}

// Enhanced field conversion function for schema form
func convertSchemaToFormFieldsEnhanced(fields []SchemaField, props SchemaFormProps) []molecules.FormFieldProps {
	var formFields []molecules.FormFieldProps

	for _, field := range fields {
		// Skip hidden fields
		if field.Hidden {
			continue
		}

		// Determine field type
		fieldType := mapSchemaTypeToFormType(field.Type, field.Widget)

		// Convert schema options to form field options
		var options []molecules.SelectOption
		for _, opt := range field.Options {
			options = append(options, molecules.SelectOption{
				Value:       opt.Value,
				Label:       opt.Label,
				Description: opt.Description,
				Disabled:    opt.Disabled,
				Icon:        opt.Icon,
			})
		}

		// Handle multi-value fields
		var values []string
		if field.Multiple && fieldType == molecules.FormFieldCheckboxGroup {
			// Convert current value to string array if needed
			if arrayVal, ok := getFieldValue(field.Name, props.Data).([]string); ok {
				values = arrayVal
			}
		}

		// Build form field props
		formField := molecules.FormFieldProps{
			Type:        fieldType,
			ID:          field.Name,
			Name:        field.Name,
			Label:       getFieldLabel(field, props.Locale),
			Value:       convertToString(getFieldValue(field.Name, props.Data)),
			Values:      values,
			Placeholder: getFieldPlaceholder(field, props.Locale),
			HelpText:    getFieldDescription(field, props.Locale),
			ErrorText:   getFieldError(field.Name, props.Errors),
			Required:    field.Required,
			Disabled:    props.ReadOnly || field.ReadOnly,
			Readonly:    field.ReadOnly,
			Options:     options,
			Multiple:    field.Multiple,

			// Validation props
			MinLength: field.MinLength,
			MaxLength: field.MaxLength,
			Min:       convertToString(field.Min),
			Max:       convertToString(field.Max),
			Pattern:   field.Pattern,

			// Layout props
			Inline:  field.Widget == "inline",
			Columns: field.ColumnSpan,

			// Date/time props
			ShowCalendar: fieldType == molecules.FormFieldDate,
			Format24:     field.Widget == "time24",

			// AutoComplete props
			SearchURL:  getFieldDataSourceURL(field),
			MinChars:   getFieldMinChars(field),
			MaxResults: getFieldMaxResults(field),
			Debounce:   300, // Default debounce
			ShowClear:  true,
			ShowIcon:   fieldType == molecules.FormFieldAutoComplete,
			FreeForm:   field.Widget == "autocomplete-free",

			// HTMX integration
			HXPost:    getFieldValidationURL(field.Reference, field.Name),
			HXTarget:  "#field-" + field.Name + "-feedback",
			HXTrigger: getFieldTrigger(props.Schema.Validation.RealTime),

			// Alpine.js integration
			AlpineModel:  "formData." + field.Name,
			AlpineChange: "validateField('" + field.Name + "')",
			AlpineBlur:   getFieldBlurValidation(props.Schema.Validation.OnBlur, field.Name),
		}

		formFields = append(formFields, formField)
	}

	return formFields
}

// Helper functions for enhanced schema integration
func getFieldDataSourceURL(field SchemaField) string {
	if field.Reference != "" {
		return "/api/search/" + field.Reference
	}
	return ""
}

func getFieldMinChars(field SchemaField) int {
	if minChars, ok := field.Attributes["minChars"].(int); ok {
		return minChars
	}
	return 2 // Default
}

func getFieldMaxResults(field SchemaField) int {
	if maxResults, ok := field.Attributes["maxResults"].(int); ok {
		return maxResults
	}
	return 10 // Default
}

// Example of how to use the enhanced FormField in SchemaForm
func SchemaFormEnhanced(props SchemaFormProps) templ.Component {
	return templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
		templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
		if templ_7745c5c3_CtxErr := ctx.Err(); templ_7745c5c3_CtxErr != nil {
			return templ_7745c5c3_CtxErr
		}
		templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
		if !templ_7745c5c3_IsBuffer {
			defer func() {
				templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
				if templ_7745c5c3_Err == nil {
					templ_7745c5c3_Err = templ_7745c5c3_BufErr
				}
			}()
		}
		ctx = templ.InitializeContext(ctx)
		templ_7745c5c3_Var1 := templ.GetChildren(ctx)
		if templ_7745c5c3_Var1 == nil {
			templ_7745c5c3_Var1 = templ.NopComponent
		}
		ctx = templ.ClearChildren(ctx)
		var templ_7745c5c3_Var2 = []any{"schema-form " + props.Class}
		templ_7745c5c3_Err = templ.RenderCSSItems(ctx, templ_7745c5c3_Buffer, templ_7745c5c3_Var2...)
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 1, "<div")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		if props.ID != "" {
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 2, " id=\"")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			var templ_7745c5c3_Var3 string
			templ_7745c5c3_Var3, templ_7745c5c3_Err = templ.JoinStringErrs(props.ID)
			if templ_7745c5c3_Err != nil {
				return templ.Error{Err: templ_7745c5c3_Err, FileName: `views/components/organisms/schema_integration_update.templ`, Line: 223, Col: 16}
			}
			_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var3))
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 3, "\"")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 4, " class=\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var4 string
		templ_7745c5c3_Var4, templ_7745c5c3_Err = templ.JoinStringErrs(templ.CSSClasses(templ_7745c5c3_Var2).String())
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `views/components/organisms/schema_integration_update.templ`, Line: 1, Col: 0}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var4))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 5, "\" x-data=\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var5 string
		templ_7745c5c3_Var5, templ_7745c5c3_Err = templ.JoinStringErrs(getSchemaFormAlpineDataEnhanced(props))
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `views/components/organisms/schema_integration_update.templ`, Line: 226, Col: 49}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var5))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 6, "\" x-init=\"initForm()\">")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Var6 := templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
			templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
			templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
			if !templ_7745c5c3_IsBuffer {
				defer func() {
					templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
					if templ_7745c5c3_Err == nil {
						templ_7745c5c3_Err = templ_7745c5c3_BufErr
					}
				}()
			}
			ctx = templ.InitializeContext(ctx)
			for _, section := range props.Schema.Sections {
				templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 7, "<div class=\"form-section space-y-4\">")
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
				if section.Title != "" {
					templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 8, "<h3 class=\"text-lg font-medium leading-6 text-foreground\">")
					if templ_7745c5c3_Err != nil {
						return templ_7745c5c3_Err
					}
					var templ_7745c5c3_Var7 string
					templ_7745c5c3_Var7, templ_7745c5c3_Err = templ.JoinStringErrs(section.Title)
					if templ_7745c5c3_Err != nil {
						return templ.Error{Err: templ_7745c5c3_Err, FileName: `views/components/organisms/schema_integration_update.templ`, Line: 243, Col: 22}
					}
					_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var7))
					if templ_7745c5c3_Err != nil {
						return templ_7745c5c3_Err
					}
					templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 9, "</h3>")
					if templ_7745c5c3_Err != nil {
						return templ_7745c5c3_Err
					}
				}
				if section.Description != "" {
					templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 10, "<p class=\"text-sm text-muted-foreground\">")
					if templ_7745c5c3_Err != nil {
						return templ_7745c5c3_Err
					}
					var templ_7745c5c3_Var8 string
					templ_7745c5c3_Var8, templ_7745c5c3_Err = templ.JoinStringErrs(section.Description)
					if templ_7745c5c3_Err != nil {
						return templ.Error{Err: templ_7745c5c3_Err, FileName: `views/components/organisms/schema_integration_update.templ`, Line: 248, Col: 28}
					}
					_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var8))
					if templ_7745c5c3_Err != nil {
						return templ_7745c5c3_Err
					}
					templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 11, "</p>")
					if templ_7745c5c3_Err != nil {
						return templ_7745c5c3_Err
					}
				}
				templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 12, "<div class=\"grid gap-4\" style=\"")
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
				var templ_7745c5c3_Var9 string
				templ_7745c5c3_Var9, templ_7745c5c3_Err = templruntime.SanitizeStyleAttributeValues(getGridColumns(props.Schema.GridCols))
				if templ_7745c5c3_Err != nil {
					return templ.Error{Err: templ_7745c5c3_Err, FileName: `views/components/organisms/schema_integration_update.templ`, Line: 253, Col: 74}
				}
				_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var9))
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
				templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 13, "\">")
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
				for _, field := range convertSchemaToFormFieldsEnhanced(section.Fields, props) {
					templ_7745c5c3_Err = molecules.FormFieldEnhanced(field).Render(ctx, templ_7745c5c3_Buffer)
					if templ_7745c5c3_Err != nil {
						return templ_7745c5c3_Err
					}
				}
				templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 14, "</div></div>")
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 15, "  ")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			if len(props.Schema.Fields) > 0 {
				templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 16, "<div class=\"grid gap-4\" style=\"")
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
				var templ_7745c5c3_Var10 string
				templ_7745c5c3_Var10, templ_7745c5c3_Err = templruntime.SanitizeStyleAttributeValues(getGridColumns(props.Schema.GridCols))
				if templ_7745c5c3_Err != nil {
					return templ.Error{Err: templ_7745c5c3_Err, FileName: `views/components/organisms/schema_integration_update.templ`, Line: 263, Col: 73}
				}
				_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var10))
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
				templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 17, "\">")
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
				for _, field := range convertSchemaToFormFieldsEnhanced(props.Schema.Fields, props) {
					templ_7745c5c3_Err = molecules.FormFieldEnhanced(field).Render(ctx, templ_7745c5c3_Buffer)
					if templ_7745c5c3_Err != nil {
						return templ_7745c5c3_Err
					}
				}
				templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 18, "</div>")
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 19, "  <div class=\"form-actions flex gap-3\">")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			for _, action := range getSchemaFormActions(props) {
				templ_7745c5c3_Err = atoms.Button(action).Render(ctx, templ_7745c5c3_Buffer)
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 20, "</div>")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			return nil
		})
		templ_7745c5c3_Err = Form(FormProps{
			Layout:   props.Schema.Layout,
			Method:   props.Schema.Method,
			Action:   props.Schema.Action,
			Class:    "space-y-6",
			HXPost:   props.Schema.SubmitURL,
			HXTarget: "#" + props.ID + "-result",
			HXSwap:   "innerHTML",
		}).Render(templ.WithChildren(ctx, templ_7745c5c3_Var6), templ_7745c5c3_Buffer)
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		if props.Debug {
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 21, "<div class=\"debug-info mt-8 p-4 bg-muted rounded-md\"><h4 class=\"font-medium mb-2\">Debug Information</h4><pre class=\"text-xs text-muted-foreground\" x-text=\"JSON.stringify(formData, null, 2)\"></pre></div>")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 22, "</div>")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		return nil
	})
}

// Enhanced Alpine.js data for schema form
func getSchemaFormAlpineDataEnhanced(props SchemaFormProps) string {
	return fmt.Sprintf(`{
		formData: %s,
		errors: %s,
		touched: {},
		dirty: {},
		submitting: false,
		
		initForm() {
			// Initialize form state
			this.setupValidation();
			this.setupConditionalLogic();
			this.setupAutoSave();
		},
		
		validateField(fieldName) {
			// Mark field as touched
			this.touched[fieldName] = true;
			
			// Trigger validation
			if (%t) {
				this.performValidation(fieldName);
			}
		},
		
		performValidation(fieldName) {
			// Real-time validation logic
			if (fieldName) {
				// Validate single field
				this.validateSingleField(fieldName);
			} else {
				// Validate all fields
				this.validateAllFields();
			}
		},
		
		validateSingleField(fieldName) {
			// HTMX will handle server-side validation
			// This can also include client-side validation
		},
		
		validateAllFields() {
			// Comprehensive validation
			Object.keys(this.formData).forEach(field => {
				this.validateSingleField(field);
			});
		},
		
		setupConditionalLogic() {
			// Watch for field changes that trigger conditional logic
			Object.keys(this.formData).forEach(fieldName => {
				this.$watch('formData.' + fieldName, (value, oldValue) => {
					this.evaluateConditions(fieldName, value, oldValue);
				});
			});
		},
		
		evaluateConditions(fieldName, value, oldValue) {
			// Evaluate conditional field visibility/requirements
			// This would integrate with the schema condition engine
		},
		
		setupAutoSave() {
			if (%t) {
				this.$watch('formData', () => {
					this.autoSave();
				});
			}
		},
		
		autoSave() {
			// Auto-save form data
			if (this.isDirty()) {
				// Debounced save logic
			}
		},
		
		isDirty() {
			return Object.keys(this.dirty).some(key => this.dirty[key]);
		},
		
		markFieldDirty(fieldName) {
			this.dirty[fieldName] = true;
		},
		
		handleSubmit() {
			this.submitting = true;
			this.validateAllFields();
			// HTMX will handle the actual submission
		},
		
		resetForm() {
			this.formData = %s;
			this.errors = {};
			this.touched = {};
			this.dirty = {};
			this.submitting = false;
		}
	}`,
		formatMapForAlpine(props.Data),
		formatMapForAlpine(props.Errors),
		props.Schema.Validation.RealTime,
		props.Schema.AutoSave,
		formatMapForAlpine(props.Data))
}

// NOTE: To integrate these new components into the existing system:
//
// 1. Update the existing FormField component to include the new field types
// 2. Update the schema form component to use the enhanced field mapping
// 3. Update the schema package to export the new field type constants
// 4. Add the new field types to the schema validation
// 5. Update the CSS to include styles for the new components
// 6. Test all new components with real schema data
//
// The new components provide:
// - Complete radio button and checkbox support
// - Advanced multi-select with search
// - Comprehensive date/time pickers
// - Autocomplete with dynamic loading
// - Full HTMX and Alpine.js integration
// - Accessibility compliance
// - Schema contract adherence
var _ = templruntime.GeneratedTemplate
